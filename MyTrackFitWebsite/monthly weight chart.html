<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Track Fit - Weight Timeline</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #111c28;
      color: #ffffff;
      padding: 2rem;
    }

    h2 {
      text-align: center;
      color: #2ba8b8;
    }

    #inputSection {
      text-align: center;
      margin-bottom: 2rem;
    }

    select, input, button {
      font-size: 16px;
      margin: 0.5rem;
      padding: 0.5rem;
      border-radius: 6px;
      border: none;
    }

    button {
      background-color: #2ba8b8;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #238a95;
    }

    #clearButton {
      background-color: #b82b2b;
    }

    #clearButton:hover {
      background-color: #952020;
    }

    #chartContainer {
      max-width: 900px;
      margin: auto;
      background: #1c2b3a;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(43, 168, 184, 0.3);
    }
  </style>
</head>
<body>
  <h2>ðŸ“ˆ Track Your Weight Over Time</h2>

  <div id="inputSection">
    <label for="monthSelect">Month:</label>
    <select id="monthSelect">
      <option value="0">January</option><option value="1">February</option>
      <option value="2">March</option><option value="3">April</option>
      <option value="4">May</option><option value="5">June</option>
      <option value="6">July</option><option value="7">August</option>
      <option value="8">September</option><option value="9">October</option>
      <option value="10">November</option><option value="11">December</option>
    </select>

    <label for="yearInput">Year:</label>
    <input type="number" id="yearInput" value="2025" min="2000" max="2100" />

    <label for="weightInput">Weight (kg):</label>
    <input type="number" id="weightInput" placeholder="e.g. 75" />

    <button onclick="addWeight()">Add</button>
    <button onclick="clearData()" id="clearButton">Clear</button>
    <button onclick="chart.resetZoom()">Reset Zoom</button>
  </div>

  <div id="chartContainer">
    <canvas id="weightChart"></canvas>
  </div>

  <script>
    const ctx = document.getElementById('weightChart').getContext('2d');
    let weightData = JSON.parse(localStorage.getItem('weightTimeline')) || {};

    function getFormattedData() {
      return Object.keys(weightData)
        .sort()
        .map(key => ({ x: key + '-01', y: weightData[key] }));
    }

    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        datasets: [{
          label: 'Weight (kg)',
          data: getFormattedData(),
          borderColor: '#2ba8b8',
          backgroundColor: 'rgba(43, 168, 184, 0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 5,
          pointHoverRadius: 7
        }]
      },
      options: {
        responsive: true,
        interaction: {
          mode: 'nearest',
          intersect: false
        },
        scales: {
          x: {
            type: 'time',
            time: {
              unit: 'month',
              tooltipFormat: 'MMM yyyy',
              displayFormats: {
                month: 'MMM yyyy'
              }
            },
            title: {
              display: true,
              text: 'Month',
              color: '#fff'
            },
            ticks: { color: '#fff' },
            grid: { color: '#444' }
          },
          y: {
            title: {
              display: true,
              text: 'Weight (kg)',
              color: '#fff'
            },
            ticks: { color: '#fff' },
            grid: { color: '#444' }
          }
        },
        plugins: {
          legend: {
            labels: { color: '#fff' }
          },
          zoom: {
            pan: {
              enabled: true,
              mode: 'x',
              drag: {
                enabled: true,
                mouseButton: 'right'  // Right-click drag to pan
              }
            },
            zoom: {
              wheel: { enabled: true },
              pinch: { enabled: true },
              mode: 'x'
            }
          }
        }
      }
    });

    function addWeight() {
      const year = parseInt(document.getElementById('yearInput').value);
      const month = parseInt(document.getElementById('monthSelect').value);
      const weight = parseFloat(document.getElementById('weightInput').value);
      if (!weight || weight <= 0) return alert("Enter a valid weight.");

      const dateKey = `${year}-${String(month + 1).padStart(2, '0')}`;
      weightData[dateKey] = weight;
      localStorage.setItem('weightTimeline', JSON.stringify(weightData));

      chart.data.datasets[0].data = getFormattedData();
      chart.update();

      document.getElementById('weightInput').value = '';
    }

    function clearData() {
      if (confirm("Clear all weight data?")) {
        weightData = {};
        localStorage.removeItem('weightTimeline');
        chart.data.datasets[0].data = [];
        chart.update();
      }
    }

    // Disable context menu on right-click over canvas
    document.getElementById('weightChart').addEventListener('contextmenu', function (e) {
      e.preventDefault();
    });
  </script>
</body>
</html>
